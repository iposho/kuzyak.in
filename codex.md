# CODEX - Сводка о приложении kuzyak.in

## Обзор проекта

**kuzyak.in** - это персональный сайт-портфолио Павла Кузякина, построенный на Next.js 14 с App Router. Сайт включает в себя блог, портфолио, контактную информацию и различные интерактивные элементы.

## Технический стек

### Основные технологии
- **Next.js 14** - React фреймворк с App Router
- **TypeScript** - типизированный JavaScript
- **SCSS** - препроцессор CSS с модулями
- **Vercel** - хостинг и деплой

### Дополнительные библиотеки
- **gray-matter** - парсинг Markdown файлов с метаданными
- **remark** - обработка Markdown в HTML
- **react-icons** - иконки
- **@vercel/analytics** - аналитика
- **@vercel/speed-insights** - метрики производительности

## Архитектура проекта

### Структура папок
```
src/
├── app/                    # App Router страницы
│   ├── blog/              # Блог и его страницы
│   ├── api/               # API endpoints
│   └── layout.tsx         # Корневой layout
├── components/            # React компоненты
│   ├── blog/             # Компоненты блога
│   ├── layout/           # Компоненты макета
│   └── ui/               # UI компоненты
├── lib/                  # Утилиты и библиотеки
├── constants/            # Константы
├── styles/               # Глобальные стили
└── types/                # TypeScript типы
```

### Ключевые особенности архитектуры
- **Статическая генерация** - все страницы блога генерируются при сборке
- **Модульная структура** - компоненты организованы по функциональности
- **Типизация** - полная типизация TypeScript
- **Оптимизация** - кэширование, lazy loading, code splitting

## Система блога

### Структура постов
Посты хранятся в папке `content/posts/` в формате:
```
content/posts/
├── post-slug/
│   ├── index.md          # Основной файл поста
│   └── preview.png       # Превью изображение
```

### Метаданные постов
```yaml
---
title: "Заголовок поста"
date: "2024-01-15"
excerpt: "Краткое описание"
tags: ["tag1", "tag2"]
category: "Категория"
featured_image: "/images/image.webp"
author: "Павел Кузякин"
draft: false
---
```

### Функции блога
- **Статическая генерация** всех страниц при сборке
- **Автоматический расчет времени чтения**
- **Система тегов и категорий**
- **Пагинация**
- **RSS лента**
- **Sitemap**
- **SEO оптимизация**

## Компоненты

### Основные компоненты
- **Header** - навигация и логотип
- **Footer** - контактная информация и ссылки
- **BlogPageContent** - контент страниц блога
- **PostSkeleton** - скелетон для загрузки
- **Pagination** - пагинация
- **ShareButtons** - кнопки социальных сетей

### Новые компоненты блога
- **NewsletterSignup** - подписка на рассылку
- **RelatedPosts** - похожие посты
- **CurrentTrack** - текущий трек Last.fm
- **TimeInYerevan** - время в Ереване
- **EasterEgg** - пасхалка
- **CookieConsent** - согласие на cookies

## API Endpoints

### Блог API
- `GET /api/blog/posts` - список постов с пагинацией
- `GET /api/blog/posts/[slug]` - конкретный пост
- `GET /api/blog/posts/[slug]/navigation` - навигация по постам
- `GET /api/blog/tags/[tag]/posts` - посты по тегу
- `GET /api/blog/categories/[category]/posts` - посты по категории
- `GET /api/blog/rss.xml` - RSS лента

### Другие API
- `GET /api/lastfm` - данные Last.fm
- `POST /api/newsletter/subscribe` - подписка на рассылку

## Стилизация

### Подход к стилям
- **SCSS модули** - изолированные стили для компонентов
- **Глобальные стили** - общие стили в `globals.scss`
- **Адаптивный дизайн** - мобильная версия
- **Темная тема** - поддержка темной темы

### Дизайн-система
- **Цветовая палитра** - синие и фиолетовые градиенты
- **Типографика** - IBM Plex Sans
- **Компоненты** - карточки, кнопки, формы
- **Анимации** - плавные переходы

## Оптимизация производительности

### Статическая генерация
- Все страницы блога генерируются при сборке
- `generateStaticParams` для предварительной генерации
- Оптимизация для Vercel с `output: 'export'`

### Кэширование
- Кэширование данных блога в памяти
- Заголовки кэширования для статических файлов
- Оптимизация изображений

### SEO
- Динамические метаданные для каждого поста
- Open Graph и Twitter Card
- Автоматическая генерация sitemap
- Структурированные данные

## Конфигурация

### Next.js конфигурация
```javascript
// next.config.js
- output: 'export' для статического экспорта
- trailingSlash: true
- оптимизация изображений
- настройки кэширования
- webpack оптимизации
```

### Vercel конфигурация
```json
// vercel.json
- настройки кэширования
- редиректы
- оптимизация для блога
```

## Переменные окружения

### Обязательные
- `NEXT_PUBLIC_SITE_URL` - URL сайта
- `YANDEX_METRIKA_ID` - ID Яндекс.Метрики
- `GOOGLE_SITE_VERIFICATION` - верификация Google

### Опциональные
- `BUILD_DATE` - дата сборки
- `NODE_ENV` - окружение

## Скрипты и команды

### Основные команды
```bash
npm run dev          # Запуск в режиме разработки
npm run build        # Сборка для продакшена
npm run start        # Запуск продакшен сервера
npm run lint         # Проверка ESLint
npm run stylelint    # Проверка Stylelint
```

## Особенности разработки

### Линтинг и форматирование
- **ESLint** - проверка JavaScript/TypeScript
- **Stylelint** - проверка SCSS
- **Prettier** - форматирование кода
- **Husky** - git hooks

### Типизация
- Полная типизация TypeScript
- Интерфейсы для всех данных
- Типы для метаданных постов

### Тестирование
- Настройка для unit тестов
- Компонентное тестирование

## Деплой и CI/CD

### Vercel деплой
- Автоматический деплой при коммитах
- Preview деплои для pull requests
- Настройки кэширования
- Аналитика и метрики

### Мониторинг
- Vercel Analytics
- Speed Insights
- Яндекс.Метрика

## Безопасность

### Защита
- Валидация входных данных
- Защита от XSS
- Безопасные заголовки
- Верификация Google

## Доступность (a11y)

### Поддержка
- Семантическая разметка
- ARIA атрибуты
- Клавиатурная навигация
- Контрастность цветов

## Мобильная версия

### Адаптивность
- Responsive дизайн
- Мобильная навигация
- Оптимизация для touch
- Быстрая загрузка

## Интеграции

### Внешние сервисы
- **Last.fm API** - текущий трек
- **Яндекс.Метрика** - аналитика
- **Vercel** - хостинг и деплой
- **GitHub** - исходный код

## Будущие улучшения

### Планируемые функции
- Система комментариев
- Поиск по блогу
- Темная тема
- Индикатор прогресса чтения
- Автоматическое оглавление
- Интеграция с сервисами рассылок

## Структура данных

### Типы постов
```typescript
interface PostMetadata {
  title: string;
  date: string;
  excerpt?: string;
  tags?: string[];
  category?: string;
  featured_image?: string;
  author?: string;
  draft?: boolean;
  readingTime?: number;
}
```

### Типы компонентов
- Все компоненты типизированы
- Props интерфейсы
- События и обработчики

## Лучшие практики

### Код
- Функциональные компоненты с hooks
- Модульная архитектура
- Переиспользуемые компоненты
- Оптимизация производительности

### SEO
- Метаданные для каждой страницы
- Структурированные данные
- Оптимизация изображений
- Быстрая загрузка

### UX
- Интуитивная навигация
- Быстрая загрузка
- Адаптивный дизайн
- Доступность

## Заключение

Проект kuzyak.in представляет собой современный, оптимизированный персональный сайт с блогом, построенный по лучшим практикам Next.js. Архитектура позволяет легко добавлять новый контент, а статическая генерация обеспечивает отличную производительность и SEO.

Ключевые преимущества:
- Быстрая загрузка и отличная производительность
- Автоматический деплой при добавлении контента
- Полная типизация и безопасность
- Адаптивный дизайн и доступность
- SEO оптимизация и аналитика
